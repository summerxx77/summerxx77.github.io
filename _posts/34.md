layout: "FMDB"
title: 数据持久化方式Sqlite 之 fmdb tips-1
date: 2016-10-13 00:05:32
tags: FMDB
---
去年在CSDN上写了一篇关于`fmdb`的文章, 那时候排版烂, 写的也不够仔细, 最近项目会用到这类的知识, 打算做一个好好的总结, 今天这篇是第一篇 介绍一下简单的使用.
> 
- `FMDatabase` 代表一个SQLite数据库。用于执行SQL语句
- `FMResultSet` 代表执行一个查询的结果 存储在一个“FMResultSet”对象中
- `FMDatabaseQueue` 如果你想在多个线程执行查询和更新,你可以使用这个类(用于在多线程中执行多个查询或更新，它是线程安全的)
- `FMDatabaseAdditions` 对 `FMDatabase`进行的扩展 (暂时还没仔细看)
- `FMDatabasePool` 用来统一管理 `FMDatabase`的对象的一个池子, 在使用这个之前先看看 `FMDatabaseQueue`是否能解决你的需求, 如不能, 在看`FMDatabasePool` 容易造成死锁, 小心使用, 不是必须使用, 尽量不用喽
<!-- more -->

首先在一个目录下创建一个数据库
```objectivec
// 数据库路径
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentDirectory = [paths objectAtIndex:0];
    NSString *dbPath = [documentDirectory stringByAppendingPathComponent:@"StaffPosition.db"];
    _db = [FMDatabase databaseWithPath:dbPath];
    [_db beginTransaction];
```
在创建表之前打开数据库
```objectivec
    if ([_db open]) {
        // 创建表
        [_db executeUpdate:@"create table weibo (created_at text, text text, current text)"];
    }
```
接下来看看如何插入数据
```objectivec
    if ([_db open]) {
        // 插入数据
        [_db executeUpdate:@"insert into weibo (created_at, text, current) values (?, ?, ?)"
        ,@"夏天", @"iOS开发者, 爱分享, 爱学习", current];
    }
```
如何更新呢?
```objectivec
    // 把current改变
    NSString *updateSql = [NSString stringWithFormat:@"update weibo set current = '%@' where created_at = '%@'", @"XXXXXXXXX", @"夏天"];    // 同样删除直接写删除的sql
    // you code
```
如何把数据库中的数据取出来呢
```objectivec
    if ([_db open]) {
    // 这里我查找所有的数据
    NSString *sql = @"select * from weibo";
    FMResultSet *rs = [_db executeQuery:sql];
    while ([rs next]) {
        // 把相应的数据打印出来
        NSLog(@"created_at = %@, text = %@, current = %@", [rs objectForColumnName:@"created_at"], [rs objectForColumnName:@"text"], [rs objectForColumnName:@"current"]);
    }
}
```

到这简单的使用就结束了~, Good. 这只是一个开始, 未完待续!


<div align=center>
微信公众号 得到最快最新的推送
</div>

<div align=center>
![](http://ww1.sinaimg.cn/large/0060lm7Tgw1f9656jhucpj307607674r.jpg)
</div>
